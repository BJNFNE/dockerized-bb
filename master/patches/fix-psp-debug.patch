From c240af799fa61f647073cfa5b94d76b26880c143 Mon Sep 17 00:00:00 2001
From: Colin Snover <github.com@zetafleet.com>
Date: Sun, 29 Oct 2017 13:15:38 -0500
Subject: [PATCH] PSP: Fix compilation failures when debug printing is enabled

---
 backends/platform/psp/display_manager.cpp | 2 +-
 backends/platform/psp/osys_psp.cpp        | 2 +-
 backends/platform/psp/png_loader.cpp      | 2 +-
 3 files changed, 3 insertions(+), 3 deletions(-)

diff --git a/backends/platform/psp/display_manager.cpp b/backends/platform/psp/display_manager.cpp
index 54ad0d3223c..fd94827e049 100644
--- a/backends/platform/psp/display_manager.cpp
+++ b/backends/platform/psp/display_manager.cpp
@@ -435,7 +435,7 @@ bool DisplayManager::renderAll() {
 	                _overlay->isDirty() ? "true" : "false",
 	                _cursor->isDirty() ? "true" : "false",
 	                _keyboard->isDirty() ? "true" : "false",
-					_imageViewer->isDirty() ? "true" : "false",
+					_imageViewer->isDirty() ? "true" : "false"
 	               );
 
 	_masterGuRenderer.guPreRender();	// Set up rendering
diff --git a/backends/platform/psp/osys_psp.cpp b/backends/platform/psp/osys_psp.cpp
index 314580fd373..5d9e3aba61d 100644
--- a/backends/platform/psp/osys_psp.cpp
+++ b/backends/platform/psp/osys_psp.cpp
@@ -314,7 +314,7 @@ void OSystem_PSP::setMouseCursor(const void *buf, uint w, uint h, int hotspotX,
 	_displayManager.waitUntilRenderFinished();
 	_pendingUpdate = false;
 
-	PSP_DEBUG_PRINT("pbuf[%p], w[%u], h[%u], hotspot:X[%d], Y[%d], keycolor[%d], scale[%d], pformat[%p]\n", buf, w, h, hotspotX, hotspotY, keycolor, cursorTargetScale, format);
+	PSP_DEBUG_PRINT("pbuf[%p], w[%u], h[%u], hotspot:X[%d], Y[%d], keycolor[%d], scale[%d], pformat[%p]\n", buf, w, h, hotspotX, hotspotY, keycolor, !dontScale, format);
 	if (format) {
 		PSP_DEBUG_PRINT("format: bpp[%d], rLoss[%d], gLoss[%d], bLoss[%d], aLoss[%d], rShift[%d], gShift[%d], bShift[%d], aShift[%d]\n", format->bytesPerPixel, format->rLoss, format->gLoss, format->bLoss, format->aLoss, format->rShift, format->gShift, format->bShift, format->aShift);
 	}
diff --git a/backends/platform/psp/png_loader.cpp b/backends/platform/psp/png_loader.cpp
index 91187ae4d8f..502ebf52ccf 100644
--- a/backends/platform/psp/png_loader.cpp
+++ b/backends/platform/psp/png_loader.cpp
@@ -144,7 +144,7 @@ bool PngLoader::findImageDimensions() {
 
 	bool status = basicImageLoad();
 
-	PSP_DEBUG_PRINT("width[%d], height[%d], paletteSize[%d], bitDepth[%d], channels[%d], rowBytes[%d]\n", _width, _height, _paletteSize, _bitDepth, _channels, _infoPtr->rowbytes);
+	PSP_DEBUG_PRINT("width[%d], height[%d], paletteSize[%d], bitDepth[%d], channels[%d], rowBytes[%d]\n", _width, _height, _paletteSize, _bitDepth, _channels, png_get_rowbytes(_pngPtr, _infoPtr));
 	png_destroy_read_struct(&_pngPtr, &_infoPtr, NULL);
 	return status;
 }
